<script type="text/javascript">
        var gk_isXlsx = false;
        var gk_xlsxFileLookup = {};
        var gk_fileData = {};
        function filledCell(cell) {
          return cell !== '' && cell != null;
        }
        function loadFileData(filename) {
        if (gk_isXlsx && gk_xlsxFileLookup[filename]) {
            try {
                var workbook = XLSX.read(gk_fileData[filename], { type: 'base64' });
                var firstSheetName = workbook.SheetNames[0];
                var worksheet = workbook.Sheets[firstSheetName];

                // Convert sheet to JSON to filter blank rows
                var jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1, blankrows: false, defval: '' });
                // Filter out blank rows (rows where all cells are empty, null, or undefined)
                var filteredData = jsonData.filter(row => row.some(filledCell));

                // Heuristic to find the header row by ignoring rows with fewer filled cells than the next row
                var headerRowIndex = filteredData.findIndex((row, index) =>
                  row.filter(filledCell).length >= filteredData[index + 1]?.filter(filledCell).length
                );
                // Fallback
                if (headerRowIndex === -1 || headerRowIndex > 25) {
                  headerRowIndex = 0;
                }

                // Convert filtered JSON back to CSV
                var csv = XLSX.utils.aoa_to_sheet(filteredData.slice(headerRowIndex)); // Create a new sheet from filtered array of arrays
                csv = XLSX.utils.sheet_to_csv(csv, { header: 1 });
                return csv;
            } catch (e) {
                console.error(e);
                return "";
            }
        }
        return gk_fileData[filename] || "";
        }
        </script><!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Excel Test Solutions Preview</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      font-family: 'Arial', sans-serif;
      display: flex;
      min-height: 100vh;
    }
    #sidebar {
      width: 250px;
      background-color: #1f2937;
      color: white;
      padding: 20px;
      position: fixed;
      height: 100%;
      overflow-y: auto;
    }
    #sidebar a {
      color: #93c5fd;
      display: block;
      padding: 10px;
      margin-bottom: 10px;
      text-decoration: none;
      border-radius: 5px;
    }
    #sidebar a:hover {
      background-color: #374151;
    }
    #content {
      margin-left: 270px;
      padding: 20px;
      flex-grow: 1;
    }
    h2 {
      color: #1f2937;
      margin-bottom: 1rem;
    }
    h3 {
      color: #374151;
      margin-top: 1.5rem;
      margin-bottom: 0.5rem;
    }
    p, li {
      color: #4b5563;
      line-height: 1.6;
    }
    canvas {
      max-width: 800px;
      margin: 20px 0;
    }
    .note {
      background-color: #eff6ff;
      border-left: 4px solid #3b82f6;
      padding: 10px;
      margin: 10px 0;
    }
  </style>
</head>
<body>
  <!-- Sidebar -->
  <div id="sidebar">
    <h2 class="text-xl font-bold mb-4">Excel Test Solutions</h2>
    <a href="#exercise1">Exercise 1: CAGR</a>
    <a href="#exercise2">Exercise 2: Survey Charts</a>
    <a href="#exercise3">Exercise 3: Cashflows</a>
    <a href="#exercise4">Exercise 4: Salaries & Financials</a>
  </div>

  <!-- Main Content -->
  <div id="content">
    <h1 class="text-3xl font-bold text-gray-800 mb-6">Excel Test Solutions Preview</h1>

    <!-- Exercise 1 -->
    <div id="exercise1" class="mb-8">
      <h2>Exercise 1: Calculate CAGR (2017–2024)</h2>
      <p><strong>Task:</strong> Find the Compound Annual Growth Rate (CAGR) for Net Operating Income (NOI) and Home Values from 2017 to 2024.</p>
      <h3>Key Points:</h3>
      <ul class="list-disc ml-6">
        <li>CAGR = [(End Value / Start Value)^(1 / Years) - 1]</li>
        <li>Years = 7 (2024 - 2017)</li>
        <li>NOI: $1,000,000 (2017) to $3,000,000 (2024)</li>
        <li>Home Value: $18,002,000 (2017) to $64,545,000 (2024)</li>
      </ul>
      <h3>Results:</h3>
      <p><strong>NOI CAGR:</strong> 16.99%</p>
      <p><strong>Home Value CAGR:</strong> 20.01%</p>
      <div class="note">
        <p><strong>Interview Tip:</strong> Explain CAGR as yearly growth rate. Say, “NOI grew 16.99% annually, Home Value 20.01% over 7 years.”</p>
      </div>
    </div>

    <!-- Exercise 2 -->
    <div id="exercise2" class="mb-8">
      <h2>Exercise 2: Survey Results Visualization</h2>
      <p><strong>Task:</strong> Create (1) a bar chart for % of people who "Strongly Agree" and (2) a 100% stacked bar chart for all responses.</p>
      <h3>Bar Chart: Strongly Agree</h3>
      <p>Shows % of people who strongly agree for each question.</p>
      <canvas id="stronglyAgreeChart"></canvas>
      <h3>100% Stacked Bar Chart: All Responses</h3>
      <p>Each bar shows the split of Strongly Agree, Agree, Undecided, Disagree, and Strongly Disagree, totaling 100%.</p>
      <canvas id="stackedBarChart"></canvas>
      <div class="note">
        <p><strong>Interview Tip:</strong> Say, “Bar chart shows only Strongly Agree %, highest for Quality Products (24%). Stacked chart shows all responses, with each bar totaling 100%.”</p>
      </div>
    </div>

    <!-- Exercise 3 -->
    <div id="exercise3" class="mb-8">
      <h2>Exercise 3: Cashflow Calculations</h2>
      <p><strong>Task:</strong> Calculate Total Positive Cashflows, Total Negative Cashflows, and Total Positive Cashflows of Apple using SUMIF/SUMIFS and INDEX MATCH.</p>
      <h3>Key Points:</h3>
      <ul class="list-disc ml-6">
        <li><strong>SUMIF:</strong> Adds values based on one condition (e.g., >0).</li>
        <li><strong>SUMIFS:</strong> Adds values with multiple conditions (e.g., Apple and >0).</li>
        <li><strong>INDEX MATCH:</strong> Looks up specific cashflows (e.g., Apple 2005).</li>
      </ul>
      <h3>Results:</h3>
      <p><strong>Total Positive Cashflows:</strong> $3,991,545</p>
      <p><strong>Total Negative Cashflows:</strong> -$2,655,033</p>
      <p><strong>Total Positive Cashflows of Apple:</strong> $2,175,011</p>
      <div class="note">
        <p><strong>Interview Tip:</strong> Say, “SUMIF sums positive or negative cashflows. SUMIFS filters by company and condition. INDEX MATCH finds specific values but isn’t needed for sums here.”</p>
      </div>
    </div>

    <!-- Exercise 4 -->
    <div id="exercise4" class="mb-8">
      <h2>Exercise 4: Salary and Financial Calculations</h2>
      <p><strong>Task 1:</strong> Calculate Average Salary, Total Employees, and Total Salary.</p>
      <h3>Results:</h3>
      <p><strong>Average Salary:</strong> $65,388.39</p>
      <p><strong>Total Employees:</strong> 224</p>
      <p><strong>Total Salary:</strong> $14,647,000</p>
      <p><strong>Task 2:</strong> Use VLOOKUP, SUMIFS, and SUMPRODUCT for financial metrics (2014–2016).</p>
      <h3>Sample Results (2014):</h3>
      <ul class="list-disc ml-6">
        <li><strong>PNC Bank:</strong> $37,309,888.16 (Dr)</li>
        <li><strong>Accounts Receivable:</strong> $1,432,389.84 (Dr)</li>
      </ul>
      <h3>Key Points:</h3>
      <ul class="list-disc ml-6">
        <li><strong>VLOOKUP:</strong> Finds account balance for a year.</li>
        <li><strong>SUMIFS:</strong> Sums Dr/Cr for a year.</li>
        <li><strong>SUMPRODUCT:</strong> Calculates net (Dr - Cr).</li>
      </ul>
      <div class="note">
        <p><strong>Interview Tip:</strong> Say, “VLOOKUP gets account values, SUMIFS sums by year, SUMPRODUCT gives net balance. For 2014, PNC Bank is $37.3M, Accounts Receivable $1.4M.”</p>
      </div>
    </div>
  </div>

  <!-- Chart.js Script -->
  <script>
    // Bar Chart for Strongly Agree
    const stronglyAgreeChart = new Chart(document.getElementById('stronglyAgreeChart'), {
      type: 'bar',
      data: {
        labels: [
          'Store locations',
          'Store hours',
          'Stores well-maintained',
          'Web site',
          'Employees friendly',
          'Product selection',
          'TV ads',
          'Quality products',
          'Overall satisfaction',
          'Would recommend'
        ],
        datasets: [{
          label: 'Strongly Agree (%)',
          data: [0.12, 0.15, 0.09, 0.18, 0.02, 0.16, 0.05, 0.24, 0.06, 0.03],
          backgroundColor: '#8884d8',
          borderColor: '#8884d8',
          borderWidth: 1
        }]
      },
      options: {
        scales: {
          y: {
            beginAtZero: true,
            ticks: {
              callback: function(value) { return (value * 100) + '%'; },
              color: '#333333'
            },
            title: {
              display: true,
              text: 'Percentage',
              color: '#333333'
            }
          },
          x: {
            ticks: {
              autoSkip: false,
              maxRotation: 45,
              minRotation: 45,
              color: '#333333'
            }
          }
        },
        plugins: {
          legend: {
            labels: { color: '#333333' }
          },
          tooltip: {
            callbacks: {
              label: function(context) {
                return `${(context.raw * 100).toFixed(1)}%`;
              }
            }
          }
        }
      }
    });

    // 100% Stacked Bar Chart
    const stackedBarChart = new Chart(document.getElementById('stackedBarChart'), {
      type: 'bar',
      data: {
        labels: [
          'Store locations',
          'Store hours',
          'Stores well-maintained',
          'Web site',
          'Employees friendly',
          'Product selection',
          'TV ads',
          'Quality products',
          'Overall satisfaction',
          'Would recommend'
        ],
        datasets: [
          {
            label: 'Strongly Agree',
            data: [0.12, 0.15, 0.09, 0.18, 0.02, 0.16, 0.05, 0.24, 0.06, 0.03],
            backgroundColor: '#8884d8',
            borderColor: '#8884d8',
            borderWidth: 1
          },
          {
            label: 'Agree',
            data: [0.14, 0.18, 0.11, 0.32, 0.06, 0.19, 0.09, 0.21, 0.28, 0.09],
            backgroundColor: '#82ca9d',
            borderColor: '#82ca9d',
            borderWidth: 1
          },
          {
            label: 'Undecided',
            data: [0.21, 0.24, 0.32, 0.30, 0.32, 0.32, 0.32, 0.28, 0.24, 0.20],
            backgroundColor: '#ffc658',
            borderColor: '#ffc658',
            borderWidth: 1
          },
          {
            label: 'Disagree',
            data: [0.21, 0.29, 0.31, 0.12, 0.43, 0.21, 0.38, 0.15, 0.25, 0.27],
            backgroundColor: '#ff7300',
            borderColor: '#ff7300',
            borderWidth: 1
          },
          {
            label: 'Strongly Disagree',
            data: [0.32, 0.14, 0.17, 0.08, 0.17, 0.12, 0.16, 0.12, 0.17, 0.41],
            backgroundColor: '#ff0000',
            borderColor: '#ff0000',
            borderWidth: 1
          }
        ]
      },
      options: {
        indexAxis: 'x',
        scales: {
          x: {
            stacked: true,
            ticks: {
              autoSkip: false,
              maxRotation: 45,
              minRotation: 45,
              color: '#333333'
            }
          },
          y: {
            stacked: true,
            beginAtZero: true,
            ticks: {
              callback: function(value) { return (value * 100) + '%'; },
              color: '#333333'
            },
            title: {
              display: true,
              text: 'Percentage',
              color: '#333333'
            }
          }
        },
        plugins: {
          legend: {
            labels: { color: '#333333' }
          },
          tooltip: {
            callbacks: {
              label: function(context) {
                return `${context.dataset.label}: ${(context.raw * 100).toFixed(1)}%`;
              }
            }
          }
        }
      }
    });
  </script>
</body>
</html>